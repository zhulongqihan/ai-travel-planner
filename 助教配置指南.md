# 🎓 助教配置指南 - AI 旅行规划师

> 本文档为助教提供详细的环境配置和运行指南

---

## 📋 前置准备

### 1. 获取 API Keys

请从**作业提交平台**获取以下配置信息：

| 配置项 | 用途 | 是否必填 |
|--------|------|---------|
| `SUPABASE_URL` | 数据库连接地址 | ✅ 必填 |
| `SUPABASE_KEY` | 数据库访问密钥 | ✅ 必填 |
| `AMAP_API_KEY` | 高德地图后端密钥 | ✅ 必填 |
| `AMAP_WEB_KEY` | 高德地图前端密钥 | ✅ 必填 |
| `ALIYUN_SPEECH_APP_KEY` | 语音识别配置 | ⭕ 可选 |
| `ALIYUN_ACCESS_KEY_ID` | 阿里云访问ID | ⭕ 可选 |
| `ALIYUN_ACCESS_KEY_SECRET` | 阿里云访问密钥 | ⭕ 可选 |

### 2. 准备自己的百炼 API Key

- 访问：https://dashscope.aliyun.com/
- 注册并创建 API Key
- 保存 `DASHSCOPE_API_KEY`

---

## 🐳 方式一：Docker 部署（推荐）

### Step 1: 拉取 Docker 镜像

```bash
docker pull crpi-6mppr7h5m3b03dk6.cn-hangzhou.personal.cr.aliyuncs.com/aitravel/ai-travel-planner:latest
```

### Step 2: 克隆项目

```bash
git clone https://github.com/zhulongqihan/ai-travel-planner.git
cd ai-travel-planner
```

### Step 3: 配置环境变量

```bash
# Windows PowerShell
copy env.docker.example .env.docker

# Linux/Mac
cp env.docker.example .env.docker
```

### Step 4: 编辑配置文件

使用任意文本编辑器打开 `.env.docker`，填入从作业平台获取的配置：

```env
# ========== Supabase 配置 ==========
SUPABASE_URL=https://xxxxxx.supabase.co    # 从作业平台获取
SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5...  # 从作业平台获取

# ========== 阿里云百炼配置 ==========
DASHSCOPE_API_KEY=sk-xxxxxxxxxxxxxxxx      # 使用您自己的 Key

# ========== 阿里云语音识别配置（可选）==========
ALIYUN_SPEECH_APP_KEY=xxxxx                # 从作业平台获取（可选）
ALIYUN_ACCESS_KEY_ID=xxxxx                 # 从作业平台获取（可选）
ALIYUN_ACCESS_KEY_SECRET=xxxxx             # 从作业平台获取（可选）

# ========== 高德地图配置 ==========
AMAP_API_KEY=xxxxxxxxxxxxxxxx              # 从作业平台获取
AMAP_WEB_KEY=xxxxxxxxxxxxxxxx              # 从作业平台获取
```

### Step 5: 启动容器

```bash
docker-compose up -d
```

### Step 6: 访问应用

浏览器打开：**http://localhost:8000**

### Step 7: 登录测试

使用以下测试账号登录：
- **邮箱**：`admin@nju.edu.cn`
- **密码**：`123456`

---

## 💻 方式二：本地开发环境部署

### Step 1: 克隆项目

```bash
git clone https://github.com/zhulongqihan/ai-travel-planner.git
cd ai-travel-planner
```

### Step 2: 创建虚拟环境

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### Step 3: 安装依赖

```bash
pip install -r requirements.txt
```

### Step 4: 配置环境变量

```bash
# 创建 .env 文件（参考 env.docker.example）
# Windows
copy env.docker.example .env

# Linux/Mac
cp env.docker.example .env
```

编辑 `.env` 文件，填入配置（同上）。

### Step 5: 运行应用

```bash
python run.py
```

### Step 6: 访问应用

浏览器打开：**http://localhost:8000**

---

## ✅ 功能测试清单

### 1. 基础功能测试

- [ ] 用户注册 / 登录
- [ ] 生成旅行计划（手动输入）
- [ ] 地图显示和标记
- [ ] 路线规划

### 2. 推荐测试用例

**国内旅行**：
```
目的地：杭州
天数：3天
预算：3000元
人数：2人
偏好：美食、风景
```

**国际旅行**：
```
目的地：东京
天数：5天
预算：10000元
人数：2人
偏好：美食、动漫、购物
```

### 3. 高级功能测试（可选）

- [ ] 语音输入识别
- [ ] 预算管理和记账
- [ ] 导出 PDF
- [ ] 深色模式切换

---

## 🐛 常见问题

### 1. Docker 镜像拉取失败

**问题**：`Error response from daemon: Get https://...`

**解决**：
```bash
# 配置 Docker 镜像加速
# 或使用 VPN
```

### 2. 端口 8000 已被占用

**解决**：
```bash
# 修改 docker-compose.yml 中的端口映射
ports:
  - "8001:8000"  # 改为 8001

# 访问时使用 http://localhost:8001
```

### 3. 地图无法显示

**原因**：高德地图 Key 配置错误或已过期

**解决**：
- 检查 `AMAP_WEB_KEY` 是否正确填写
- 确认 Key 的有效期

### 4. AI 生成失败

**原因**：`DASHSCOPE_API_KEY` 配置错误或余额不足

**解决**：
- 检查 Key 是否正确
- 登录百炼平台查看余额和配额

### 5. 语音识别不工作

**原因**：语音配置未填写或浏览器不支持

**解决**：
- 语音识别是可选功能，不影响核心功能
- 可以跳过语音测试，直接使用手动输入

---

## 📊 性能指标

- **启动时间**：< 5 秒
- **AI 生成时间**：10-30 秒（取决于行程复杂度）
- **地图加载时间**：< 2 秒
- **内存占用**：约 300 MB

---

## 📞 技术支持

如遇到问题，请：

1. 查看项目 [README.md](README.md)
2. 查看 [DOCKER_README.md](DOCKER_README.md)
3. 查看 GitHub Issues：https://github.com/zhulongqihan/ai-travel-planner/issues

---

## 📸 预期效果

成功运行后，您应该看到：

1. ✅ 现代化的登录界面
2. ✅ 带有语音输入按钮的规划表单
3. ✅ 实时显示的地图（右侧）
4. ✅ 完整的旅行计划展示
5. ✅ 路线规划和导航信息
6. ✅ 浮动工具栏（导出、分享等）

更多截图请查看项目的 `界面功能截图/` 目录。

---

## 🎯 评分重点

本项目的亮点包括：

1. **完整的 Docker 部署**：一键启动，开箱即用
2. **四层地理编码系统**：支持全球地点搜索
3. **现代化 UI 设计**：2700+ 行精心设计的 CSS
4. **智能 AI 规划**：完善的 Prompt 工程
5. **实用工具集成**：导出、分享、预算管理
6. **完善的文档**：README、Docker 文档、配置指南

---

<div align="center">

**祝评审顺利！🎓✨**

如有疑问，请联系项目作者或查看 GitHub 仓库。

</div>

